<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POWER Fitness | GYM Clothes</title>

    <!-- ================== CSS FILE LINK ======================= -->

    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/cart.css">

    <!-- ================== GOOGLE FONTS LINK ======================= -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@1,500&display=swap" rel="stylesheet">

    <!-- ================== WEB SHORTCUT ICON ======================= -->

    <link rel="shortcut icon" type="image/png" href="images/logo.avif">

    <!-- ================== FONT AWESOME LINK ======================= -->

    <script src="https://kit.fontawesome.com/dee3a677e8.js" crossorigin="anonymous"></script>

</head>

<body>

    <!-- ================== HEADER NAVIGATION ======================= -->

    <div class="header">

        <div class="header__navbar">

            <div class="header__logo">
                <a href="index.html" class="logo"><img src="images/logo.avif" alt="IRONGEAR" class="store__logo"></a>

                <input type="text" name="" id="searchBar" placeholder="Search">
                <i class="fa-solid fa-magnifying-glass bar__search"></i>

            </div>

            <nav class="header__nav">
                <ul class="header__ul">
                    <li class="header__li"><a href="index.html" class="header__link">Home</a></li>
                    <li class="header__li"><a href="product.html" class="header__link">Products</a></li>
                    <li class="header__li"><a href="signup.html" class="header__link">Sign up</a></li>
                    <li class="header__li"><a href="#name__cart" class="header__link" id="sign__succ">Account</a></li>
                    <li class="header__li"><a href="#cart__side" class="cart header__link"><i
                                class="fa-solid fa-cart-shopping cart__icon"></i>
                            <p id="cart__count">0</p>
                        </a></li>
                </ul>
            </nav>

        </div>

    </div>


    <!-- =================== TOGGLE NAVBAR ======================== -->

    <div id="nav__navbar">

        <!-- <ul class="nav__ul">
            <li class="nav__li"><a href="index.html" class="nav__link">Home</a></li>
            <li class="nav__li"><a href="product.html" class="nav__link">Products</a></li>
            <li class="nav__li"><a href="login.html" class="nav__link" id="sign__succ"><img src="images/profileimg.webp" alt="" class="no__imgs" id="sign__img"><p class="sign__in">Sign in</p></a></li>
            <li class="nav__li"><a href="signup.html" class="nav__link">Sign up</a></li>
            <li class="nav__li"><a href="#cart__side" class="nav__link"><i class="fa-solid fa-cart-shopping cart__icon"></i><p id="cart__count">0</p></a></li>
        </ul> -->


        <ul class="nav__ul">
            <li class="nav__li"><a href="index.html" class="nav__link" id="home__lick">
                    <i class="fa-solid fa-house home__icon"></i>
                    <br>
                    Home</a></li>
            <li class="nav__li"><a href="product.html" class="nav__link" id="home__lick">

                    <i class="fa-solid fa-store home__icon"></i>
                    <br>

                    Products</a></li>
            <li class="nav__li"><a href="signup.html" class="nav__link" id="home__lick">

                    <i class="fa-solid fa-user-plus home__icon"></i>

                    <br>

                    Sign up</a></li>
            <li class="nav__li"><a href="#name__cart" class="nav__link" id="home__lick" id="sign__succ">

                    <i class="fa-solid fa-user home__icon"></i>

                    <br>

                    Account</a></li>
            <li class="nav__li"><a href="#cart__side" class="cart nav__link"><i
                        class="fa-solid fa-cart-shopping cart__icon" id="cart__nav"></i>
                    <p id="cart__count" class="cart__counte">0</p>
                </a></li>
        </ul>


    </div>

    <!-- ================== NAME CART DESIGN ====================== -->

    <div class="sidebar" id="name__cart">

        <div class="close__icon">
            <a href="#" class="close__link"><i class="fa-solid fa-xmark sidebar__close"></i></a>
        </div>

        <!-- <span class="create__text" style="display: none;">Please Create a account</span> -->

        <div class="name__sec">

            <div class="name__text">
                <h3 class="name__text"> <span class="wel__text">Welcome,</span> <span class="sign__inw" id="sign__inw"></span><span
                        class="loginIN"></span></h3>
            </div>

            <div class="view__prof" id="view__prof">
                <a href="login.html" class="view__link">View profile</a>
            </div>


        </div>

        <div class="logout__btn" id="name__bbtnn">
            <button type="submit" class="logout-btn name__btn" id="logout_btn">Logout</button>
        </div>

    </div>


    <!-- =================== CART SECTION ===================== -->

    <div class="sidebar" id="cart__side">

        <div class="close__icon">
            <a href="#" class="close__link"><i class="fa-solid fa-xmark sidebar__close"></i></a>
        </div>

        <div class="head">
            <p>My Cart</p>
        </div>

        <div class="cartdisp"></div>

        <div class="totalPriceCart">
            <div class="subtotal">total</div>
            <div class="priceView">
               <h2><span>Rs,</span> 00</h2> 
            </div>
        </div>

        <!-- <div id="cartItem">Your cart is empty</div>
        <p class='cart__title'></p>
        <div class="foot">
            <h3>Total</h3>
            <h2 id="total" class="toishdj">$ 0.00</h2>
        </div> -->

        <div class="buy__btn">
            <a href="cart.html" class="buy__button">View cart</a>
        </div>

    </div>

    <!-- ======================== PROFILE SECTION ======================= -->

    <div id="name__in" style="display: none;">

        <div class="name__logo">
            <a href="index.html"><img src="images/logo.avif" alt="" class="name__pic"></a>
        </div>

        <div class="user__img">
            <!-- <div class="prof__image">
                    <img src="images/profileimg.webp" alt="" class="no__img">
                
                    <label for="input-file" class="update__btn">
                        <i class="fa-solid fa-plus update__icon"></i>
                    </label>
    
                    <input type="file" accept="images/jpeg,images/png, images/jpg" id="input-file">
    
                </div> -->

            <h1 class="welcome__nams" id="welconme__name"> Name:
                <span class="welcome__name"></span>
                <input type="text" name="welcome__namew" class="welcome__namew" style="display: none;" required>
                <span id="welcome__users"></span>

            </h1>
            <h1 class="welcome__nams"> Email:
                <span class="welcome__pass"></span>

                <input type="email" class="welcome__mail" style="display: none;" required>
                <span id="user__email"></span>

            </h1>

            <!-- <div class="location">
                    <h2 class="coun__text">Country: <span class="location__text">Pakistan</span></h2>
                    <h2 class="coun__text">City: <span class="location__tex">Faisalabad</span></h2>
                </div> -->

            <div class="dit__btn">
                <button id="eidt__prof">Edit profile</button>
            </div>

            <div class="dit__btn">
                <button id="save__prof" style="display: none; width: 70%; margin-right: auto; margin-left: auto;">Save profile</button>
            </div>

            <div class="logout__btn">
                <button type="submit" id="out__btn">Logout</button>
            </div>

            <!-- <div class="sav__btn">
                    <button class="sav__button">Save</button>
                  </div>  -->


        </div>

    </div>

    <!-- =================== CUSTOMER LOGIN ======================= -->


    <section class="contact__section" id="login__sec">
        <h2 class="log__text">Customer Login</h2>

        <form>
            <div class="form-group">
                <!-- <input type="email" name="email" id="email" class="mail__input" placeholder="Email">
            <label for="email" class="mail__label">email</label> -->

                <input type="text" class="mail__input" id="name" name="name" placeholder="Name">
                <!-- <label for="name" class="mail__label">name</label> -->

            </div>
            <div class="form-group">
                <input type="password" name="password" id="password" class="mail__input" placeholder="Password">
                <!-- <label for="password" class="mail__label">password</label> -->
            </div>

            <div class="form-group" id="mail__group" style="display: none;">
                <input type="email" name="email" id="email" class="mail__input" placeholder="Email">
                <!-- <label for="password" class="mail__label">password</label> -->
            </div>

            <button type="submit" onclick="loginData()" class="sign-btn" id="save_btn">Sign in</button>

            <!-- <button type="reset" class="sign-btn"  id="">reset</button> -->
        </form>
        </div>
    </section>


    <!-- <script src="js/script.js"></script> -->
    <script src="js/signup.js"></script>
    <!-- <script src="js/logout.js"></script> -->
    <!-- <script src="js/profile.js"></script> -->
    <script src="js/login.js"></script>
</body>

<script>

    window.onload = function () {

        let editName = localStorage.getItem("editName");

        if (editName === "true") {
  
        }

        // let welcome__namewe = document.querySelector(".welcome__namew");


        let saveName = localStorage.getItem("saveName");
        if (saveName === "true") {
            let welcome__namewe = localStorage.getItem("welcomeName");
            document.querySelector(".loginIN").innerHTML = welcome__namewe;

            let sign__inw = document.querySelector(".sign__inw");

            sign__inw.style.display = "none";


            let welcome__namew = document.querySelector(".welcome__namew");

            welcome__namew.style.display = "none";

            document.querySelector("#welcome__users").innerHTML = welcome__namewe;

            //    document.querySelector(".welcome__namew").innerTEXT = welcome__namewe;

            let welcome__name = document.querySelector(".welcome__name");

            welcome__name.style.display = "none";


            welcome__namew.disabled = true;
            let welcome__pass = document.querySelector(".welcome__pass");

            welcome__pass.style.display = "none";

            let user__email = document.querySelector("#user__email");

            user__email.style.display = "block";

            let welcomeEmail = localStorage.getItem("welcomeEmail");

            user__email.innerHTML = welcomeEmail;

            // document.querySelector("#user__email").innerHTML = welcomeEmail;
        }

        let signIn = localStorage.getItem("signin");

        let contact__sections = document.querySelector(".contact__section");

        let name__ins = document.querySelector("#name__in");

        var logout_btnes = document.querySelector("#logout_btn");

        var view__link = document.querySelector("#view__prof");

        let wel__text = document.querySelector(".wel__text");

        // let create__text = document.querySelector(".create__text");


        if (signIn === "true") {

            let userNamew = localStorage.getItem("name");

            document.querySelector(".welcome__name").textContent = userNamew;

            let userPass = localStorage.getItem("email");
            document.querySelector(".welcome__pass").textContent = userPass;

            contact__sections.style.display = "none";

            name__ins.style.display = "block";

            let userNamee = localStorage.getItem("name");

            document.querySelector("#sign__inw").innerHTML = userNamee;


            logout_btnes.style.display = "block";
            view__link.style.display = "block";
            wel__text.style.display = "block";

        } else {
            logout_btnes.style.display = "none";
            view__link.style.display = "none";
            wel__text.innerHTML = "Please create a account";
            // create__text.style.display = "block";
        }

    }

    function logPage(e) {
        e.preventDefault();

        localStorage.clear();

        location.href = "index.html";

        var logout_btnes = document.querySelector("#logout_btn");

        logout_btnes.style.display = "none";
    }

    var logout_btnes = document.querySelector("#logout_btn");

    logout_btnes.addEventListener("click", logPage);


    function outPage(e) {
        e.preventDefault();

        localStorage.clear();

        location.href = "login.html";

        // var name__btn = document.querySelector(".name__btn");

        // name__btn.style.display = "none";
    }

    var name__btn = document.querySelector("#out__btn");

    name__btn.addEventListener("click", outPage);






// Creating the Products Array
const products = [];


// Modify the event listener for the "Add to cart" button

//Selecting all the prod__btn as there are going to be alots of items card
document.querySelectorAll(".prod__btn").forEach(cartBtn => {
  // naming each .prod__btn as the cartBtn....  YOU SHOULD USE THE FOREACH METHOD INSTEAD OF FOR LOOP
  cartBtn.addEventListener("click", (event) => {
  // Taking the priceELement  
    let priceElement = event.target.parentElement.parentElement.querySelector(".prod__price");
  // Taking the priceText  
    let priceText = priceElement.textContent.trim();
  // and then parseFlaot it to convert it to a number from a string  
    let price = parseFloat(priceText);
  
  // Creating product object which we will pass in the products Array  
    let product = {
      image: event.target.parentElement.parentElement.querySelector(".prod__img").src,
      name: event.target.parentElement.parentElement.querySelector(".prod__name").textContent,
      price: price,
      totalPrice: price,
      quantity: 1,
    };

    //Calling the addItemToLocal function
    addItemToLocal(product);
  });
});

 // Passing product(the one we created above) in the addItemToLocal 
function addItemToLocal(product) {
  // this line of code says that there is something in array or there is an emtpy array
  let cartItem = JSON.parse(localStorage.getItem("prdInCart")) || [];
  let found = false;

  // HERE ALSO I USED FOREACH YOU SHOULD ALSO USE THIS
  cartItem.forEach((item) => {
    if (product.name === item.name) {
      // now check if the product name and the item name matche if it does then 
      // add the quantiity 
      // update the total price 
      // and set true the found
      item.quantity++;
      item.totalPrice += product.price;
      found = true;
    }
  });

  if (!found) {
    cartItem.push(product);
  }

  localStorage.setItem("prdInCart", JSON.stringify(cartItem));
  cartNumberDisplay();
  location.href = "#cart__side";
  window.location.reload();
}

function cartNumberDisplay() {
  let cartItem = JSON.parse(localStorage.getItem("prdInCart")) || [];
  let cartNumbers = cartItem.reduce((acc, item) => acc + item.quantity, 0);
  document.querySelector("#cart__count").textContent = cartNumbers;
  document.querySelector(".cart__counte").textContent = cartNumbers;
}

function dispCartItem() {
  let html = "";
  let cartItem = JSON.parse(localStorage.getItem("prdInCart")) || [];
  cartItem.forEach((item) => {
    html += `
      <div class="cartlist">
        <img src="${item.image}" alt="" id='cart__image'>
        <h3 class='cart__name'>${item.name}</h3>
        <h3 class='cart__price'>Rs, ${item.price}</h3>
        <div class="quan__boxes">
          <input type='button' name='quan' class="min__btn" value='-'>
          <input type="number" class='cart__quan' value="${item.quantity}" readonly>
          <input type='button' name='quan' class="pl__btn" value='+'>
        </div>
        <h3 class='cart__tot'>Rs, ${item.totalPrice}</h3>
        <div class="remove__icon">
          <i class="fa-solid fa-xmark reoveItem"></i>
        </div>
      </div>`;
  });
  document.querySelector(".cartdisp").innerHTML = html;
}
dispCartItem();


// HERE IS THE INCREMENT AND DECREMENT FUNCTIONALITY

// Selecting all the .pl__btn as there are alots of items card
// Keep remeber when we have more than one elements in our HTML we use querrySelectorAll to get them
// and then we use forEach method to get data from it.

document.querySelectorAll(".pl__btn").forEach(btn => {
  // now exactly in our previous addToCart btn here we are getting the btn (for each of the item card)
  btn.addEventListener('click', (event) => {
    // the input value is the one that gets added after clicking the plus btn
    let input = event.target.parentElement.querySelector(".cart__quan");
    // converted the input value to numerice value..
    input.value = parseInt(input.value) + 1;
    // Function for updating the quantity 
    updateQuantity(input);
  });
});


// NOW HERE IS THE DECREMENT FUNCTIONLAITY

// Exactly same here we are also selecting all the min__btn as there are alot of item cards
document.querySelectorAll(".min__btn").forEach(btn => {
  btn.addEventListener('click', (event) => {
    let input = event.target.parentElement.querySelector(".cart__quan");
    // Here we are saying that if the input value is greater then one then decrement otherwise don't
    if (parseInt(input.value) > 1) {
      input.value = parseInt(input.value) - 1;
      updateQuantity(input);
    }
  });
});


// NOW THIS IS THE FUNCTINO TO UPDATES THE QUANTITY WE ARE DOING IT ONLY FOR TOTAL

function updateQuantity(input) {
  // 1) first getting the cartItem from the locastorage
  let cartItem = JSON.parse(localStorage.getItem("prdInCart")) || [];
  // 2) second getting the name of the item from the HTML 
  let itemName = input.parentElement.parentElement.querySelector('.cart__name').textContent;
  // 3) than we are using find method that if there is the item.name(from the localstorage) and the itemName(from the HTML) are same
  let item = cartItem.find(item => item.name === itemName);
  // 4) then take the item.quantity
  item.quantity = parseInt(input.value);
  // 5) and update the totlPrice by multiplying the item.price with the quantity number
  item.totalPrice = item.price * item.quantity;
  // 6) lasting updating the cartItme in the locastorage
  localStorage.setItem("prdInCart", JSON.stringify(cartItem));
  cartNumberDisplay();
  cartPrice();
}

function cartPrice() {
  let cartItem = JSON.parse(localStorage.getItem("prdInCart")) || [];
  let subTotal = cartItem.reduce((acc, item) => acc + item.totalPrice, 0);
  document.querySelector(".priceView h2").textContent = subTotal;
}

document.querySelectorAll(".reoveItem").forEach(removeBtn => {
  removeBtn.addEventListener("click", () => {
    let cartItem = JSON.parse(localStorage.getItem("prdInCart")) || [];
    let itemName = removeBtn.parentElement.parentElement.querySelector('.cart__name').textContent;
    let updatedCart = cartItem.filter(item => item.name !== itemName);
    localStorage.setItem("prdInCart", JSON.stringify(updatedCart));
    dispCartItem();
    cartNumberDisplay();
    cartPrice();
  });
});

cartNumberDisplay();
cartPrice();




</script>

</html>